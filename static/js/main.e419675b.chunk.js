(this["webpackJsonpmage-js"]=this["webpackJsonpmage-js"]||[]).push([[0],{23:function(e,t,n){e.exports=n(35)},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(12),o=n.n(i),c=n(2),l=function(e){return{type:"UPDATE_TILE",payload:e}},u=function(e){return{type:"SPELLBOOK_SHOW",payload:e}},s=function(e){return{type:"SPELLBOOK_LENGTH_SET",payload:e}},f=function(e){return{type:"SPELLBOOK_LOAD",payload:e}},d=function(e){return{type:"BATTLE_SHOW",payload:e}},h=function(e){return{type:"BATTLE_SPELL_TITLE_SHOW",payload:e}},m=function(e){return{type:"BATTLE_MENU_SHOW",payload:e}},b=function(e){return{type:"BATTLE_RESULT_SET",payload:e}},y=function(e){return{type:"PLAYER_ANGLE_SET",payload:e}},g=function(e){return{type:"PLAYER_POSITION_SET",payload:e}},p=function(e){return{type:"PLAYER_MOVED_SET",payload:e}},w=function(e){return{type:"MOVE_SHOW",payload:e}},E=function(e){return{type:"CHAT_MESSAGES_SET",payload:e}},v=function(e){return{type:"SCENARIO_SHOW",payload:e}},O=function(e){return{type:"START_BUTTON_SHOW",payload:e}},x=function(e){return{type:"UPDATE_PAGE",payload:e}},j=function(){var e=Object(c.d)(),t=Object(c.e)((function(e){return e.screen.viewBox}));Object(a.useEffect)((function(){function n(){e({type:"RESIZE_SCREEN",payload:function(e){var t=window.innerHeight>9*window.innerWidth/16?9*window.innerWidth/16:window.innerHeight,n=window.innerHeight>9*window.innerWidth/16?window.innerWidth:16*window.innerHeight/9,a=(window.innerWidth-n)/2;return{height:t,width:n,offset:a*(e.width/n),windowOffset:(window.innerWidth-n)/-2}}(t)})}return window.addEventListener("resize",n),function(){return window.removeEventListener("resize",n)}}),[t,e])};var S=function(e){var t,n=e.r+50,a=n/4,i=e.cx+n/-2,o=180*e.angle/Math.PI>-.01?e.cy+a/-2-e.r-35:e.cy+a/-2+e.r+35,c=e.hp/e.maxHP,l=(t=c)>.5?"lightgreen":t>.1?"yellow":"red";return r.a.createElement("g",null,r.a.createElement("rect",{width:n,height:a,x:i,y:o,fill:"grey",opacity:"0.5",pointerEvents:"none"}),r.a.createElement("rect",{width:c>=0?n*c:0,height:a,x:i,y:o,fill:l,opacity:"0.8",pointerEvents:"none"}),r.a.createElement("text",{fontFamily:"Arial Black",fontSize:a,fill:"white",x:e.cx,y:o+a/2,textAnchor:"middle",alignmentBaseline:"central"},e.hp))},k={earth:"brown",wind:"indigo",fire:"red",water:"blue",force:"grey",prismatic:"white",delta:"yellow",stone:"lightgray",sand:"goldenrod",magma:"maroon",frostfire:"cyan",lightning:"yellow",ice:"lightseagreen"},A={Circle:function(e){return r.a.createElement("circle",{cx:e.cx,cy:e.cy,r:e.r,fill:"white"})},Player:function(e){return r.a.createElement("g",null,r.a.createElement("circle",{cx:e.cx+125,cy:e.cy,r:"10",fill:"purple",transform:"rotate(".concat(180*e.angle/Math.PI," ").concat(e.cx," ").concat(e.cy,")")}),r.a.createElement(S,{cx:e.cx,cy:e.cy,r:e.r,hp:e.hp,maxHP:e.maxHP,angle:e.angle}),r.a.createElement("use",{xlinkHref:"#playerSprite",width:75,height:75,x:e.cx+-37.5,y:e.cy+-37.5-10}))},Enemy:function(e){return r.a.createElement("g",null,r.a.createElement("text",{x:e.cx,y:e.cy+e.r+20,fontSize:"20",fontFamily:"Arial Black",stroke:"white",strokeWidth:"0.5",textAnchor:"middle",alignmentBaseline:"central"},e.name),r.a.createElement(S,{angle:e.angle,cx:e.cx,cy:e.cy,r:e.r,hp:e.hp,maxHP:e.maxHP}),r.a.createElement("g",{transform:"rotate(".concat(180*e.angle/Math.PI," ").concat(e.cx," ").concat(e.cy,")")},r.a.createElement("path",{fill:"red",d:"\n                    M".concat(e.cx," ").concat(e.cy-e.r," \n                    L").concat(e.cx+1.5*e.r," ").concat(e.cy," \n                    L").concat(e.cx," ").concat(e.cy+e.r,"Z")}),r.a.createElement("circle",{cx:e.cx,cy:e.cy,r:e.r,fill:"red"})))},Spells:{bolt:function(e){return r.a.createElement("circle",{key:e.id,cx:e.position.x,cy:e.position.y,r:e.circleRadius,fill:k[e.name.element]})},ball:function(e){return r.a.createElement("circle",{key:e.id,cx:e.position.x,cy:e.position.y,r:e.circleRadius,fill:k[e.name.element]})},rain:function(e){return r.a.createElement("circle",{key:e.id,cx:e.position.x,cy:e.position.y-e.circleRadius-150,r:e.circleRadius,fill:k[e.name.element]},r.a.createElement("animateTransform",{id:"rain".concat(e.id),attributeName:"transform",type:"translate",from:"0 0",to:"0 150",dur:"1.5s",begin:"indefinite",fill:"freeze"}))}},Attacks:{Slash:function(e){return r.a.createElement("circle",{key:e.id,cx:e.position.x,cy:e.position.y,r:e.circleRadius,fill:"white"})},Shot:function(e){return r.a.createElement("circle",{key:e.id,cx:e.position.x,cy:e.position.y,r:e.circleRadius,fill:"white"})}}},T=function(e){switch(e.label){case"Spell":return A.Spells[e.name.shape](e);case"Attack":return A.Attacks[e.name](e);case"Exploding":return A.Spells.bolt(e);case"Circle Body":return r.a.createElement(A.Circle,{key:e.id,body:e.id,cx:e.position.x,cy:e.position.y,r:e.circleRadius});case"Player":return r.a.createElement(A.Player,{body:e.id,key:e.id,hp:e.hp,maxHP:e.maxHP,cx:e.position.x,cy:e.position.y,r:e.circleRadius,angle:e.angle});case"Enemy":return r.a.createElement(A.Enemy,{key:e.id,body:e.id,hp:e.hp,maxHP:e.maxHP,cx:e.position.x,cy:e.position.y,r:e.circleRadius,angle:e.angle,name:e.name});default:return}},B=function(){return Object(c.e)((function(e){return e.world.bodies})).map((function(e){return T(e)}))},P=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",Object.assign({},e,{fill:"#1101AB",mask:"url(#menu-background-mask)"})),r.a.createElement("rect",Object.assign({},e,{fill:"#1101AB",stroke:"white",strokeWidth:"30",filter:"url(#menu-filter)",mask:"url(#menu-background-mask)"})),r.a.createElement("rect",Object.assign({},e,{fill:"transparent",stroke:"white",strokeWidth:"30",mask:"url(#menu-background-mask)"})))},L=function(){var e=Object(c.e)((function(e){return e.screen.viewBox}));return r.a.createElement("rect",{width:e.width,height:e.height,x:e.width/-2,y:e.height/-2,fill:"black",opacity:"0.2",pointerEvents:"none"})},I=["ELEMENTAL RUNES GO FIRST","(FU) FOR FIRE","(VE) FOR WIND","(GA) FOR WATER","EARTH WITH (TI)","COMBINE THEM WITH (KO)","OR DIVIDE THEM WITH (SU)","ADD (MU) FOR EXPLOSION","AND FOR RAIN USE (LU)"],_=function(e){return r.a.createElement(r.a.Fragment,null,e.list.map((function(e,t){return r.a.createElement("text",{key:"menu".concat(t),x:0,y:50*t-500,fontSize:"25",fontFamily:"Arial Black",fill:"white",textAnchor:"middle",alignmentBaseline:"central"},e)})))},M=function(){var e=Object(c.e)((function(e){return e.screen.viewBox}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement(P,{height:e.height,width:9*e.height/16,x:9*e.height/16/-2,y:e.height/-2,fill:"#1101AB",ry:"20"}),r.a.createElement(_,{list:I}))},R=n(22),F=n(1),W=n(4),H=n(15),U={element:["force"],range:"10",damage:[{amount:1,sides:6,source:"force"}],effect:[],origin:{x:0,y:0},effectChance:[],maximize:!1,combine:!1,empower:!1,target:["single"]},C=function(e,t){for(var n=[],a=[],r=Object(F.a)(Object(F.a)({},U),{},{origin:Object(F.a)({},t)}),i=Object(F.a)({},r),o=0;o<e.length;o+=2)n.push(e[o]+e[o+1]);n=N(n);for(var c=0;c<n.length;c++)void 0!==z[n[c]]&&(r=G(r,n[c],n[c-1]||null),c!==n.length-1&&"SU"!==n[c]||(a.push(r),r=Object(F.a)({},i)));return 0===a.length&&a.push(r),a.forEach((function(e){return e.name=q(e)})),a},N=function e(t){var n=Object(W.a)(t);return 0===n.length||"TI"===n[0]||"FU"===n[0]||"GA"===n[0]||"VE"===n[0]?n:(n.splice(0,1),e(n))},z={TI:{element:["earth"],damage:[{amount:1,sides:6,source:"earth"}]},FU:{element:["fire"],damage:[{amount:1,sides:6,source:"fire"}]},GA:{element:["water"],damage:[{amount:1,sides:6,source:"water"}]},VE:{element:["wind"],damage:[{amount:1,sides:6,source:"wind"}]},LO:{element:["force"],damage:[{amount:1,sides:6,source:"force"}]},SU:{},KO:{combine:!0},MU:{target:["ball"]},LU:{target:["all"]}},D={TI:["TI","VE","GA"],FU:["FU","GA","TI"],GA:["GA","FU","VE"],VE:["VE","TI","FU"],LO:["TI","VE","GA","FU","LO"],SU:[],KO:["LO, SU"],MU:["SU"],LU:["SU"]},G=function(e,t,n){var a=Object(F.a)({},e);return function(e,t){return 0===D[e].filter((function(e){return e===t})).length}(t,n)&&function(e,t,n){for(var a in z[n])"boolean"===typeof t[a]?t[a]=z[n][a]:t[a]=[].concat(Object(W.a)(e[a]),Object(W.a)(z[n][a]))}(e,a,t),a},V={single:"bolt",all:"rain",self:"armor",cone:"breath",ball:"ball"},q=function(e){var t=e.element.filter((function(e){return"force"!==e}))[0]||"force";if(!0===e.combine){var n,a={earth:0,fire:0,water:0,wind:0,force:0},r=Object(R.a)(e.element);try{for(r.s();!(n=r.n()).done;){a[n.value]+=1}}catch(i){r.e(i)}finally{r.f()}t=a.earth>1&&a.fire>1&&a.wind>1&&a.water>1?"prismatic":function(e){return e.earth>0?e.water>0&&e.fire>0&&0===e.wind?"delta":e.water>0?"stone":e.wind>0?"sand":e.fire>0?"magma":"earth":e.fire>0?0===e.water&&e.earth>0&&e.wind>0?"delta":e.water>0?"frostfire":e.wind>0?"lightning":"fire":e.water>0?0===e.fire&&e.earth>0&&e.wind>0?"delta":e.wind>0?"ice":"water":e.wind>0?e.fire>0&&e.water>0&&0===e.earth?"delta":"wind":"force"}(a)}return{element:t,shape:V[e.target[e.target.length-1]]}},Z=function(){var e=Object(c.e)((function(e){return e.screen.viewBox})),t=Object(c.e)((function(e){return e.spellbook.length}))+2,n=function(){var e=Object(c.e)((function(e){return e.player.position})),t=Object(a.useRef)(),n=Object(c.d)(),r=Object(c.e)((function(e){return e.spellbook.length})),i=Object(a.useState)([]),o=Object(H.a)(i,2),l=o[0],s=o[1];return Object(a.useEffect)((function(){var a=function(a){if("Escape"===a.key&&(n(u(!1)),n(m(!0))),/^[A-Za-z]$/.test(a.key)&&l.length<r){var i=[].concat(Object(W.a)(l),[a.key.toUpperCase()]);s(i)}"Enter"===a.key&&(document.querySelectorAll(".spellLetter").forEach((function(e){return e.beginElement()})),n(f(C(l,e))),t.current=setTimeout((function(){n(u(!1)),n(m(!0))}),1e3))};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a),clearTimeout(t.current)}}),[l,n,e,r]),l}(),i=4*e.width/5,o=1*e.height/4,l=i/t>200?200:i/t,s={x:i/-2,y:o/-2,width:i,height:o,pointerEvents:"none"},d=function(){return r.a.createElement("animate",{className:"spellLetter",attributeName:"opacity",to:"0",begin:"indefinite",calcMode:"discrete",dur:"0.1s",fill:"freeze"})};return r.a.createElement(r.a.Fragment,null,r.a.createElement(L,null),r.a.createElement("rect",Object.assign({},s,{fill:"#1101AB",mask:"url(#spellbook-mask)"}),d()),r.a.createElement("rect",Object.assign({},s,{filter:"url(#spellbook-filter)",mask:"url(#spellbook-mask)"}),d()),r.a.createElement("rect",Object.assign({},s,{stroke:"white",fill:"transparent",strokeWidth:"30",mask:"url(#spellbook-mask)"}),d()),n.map((function(e,t){return r.a.createElement("text",{key:"word".concat(t),x:(t+1-n.length)*(l/2)+t*l/2,y:"0",textAnchor:"middle",alignmentBaseline:"central",fontSize:l,fontFamily:"Arial Black"},e,r.a.createElement("animate",{className:"spellLetter",attributeName:"fill",from:"black",to:"white",begin:"indefinite",dur:"1s",fill:"freeze"}))})))},Y=function(e){var t=50*e.title.length+100;return r.a.createElement("g",null,r.a.createElement("g",null,r.a.createElement("rect",{x:t/-2,y:380/3/-2-450,width:t,height:380/3,fill:"#1101AB",stroke:"white",strokeWidth:"10"}),r.a.createElement("text",{fill:"white",y:"-450",alignmentBaseline:"central",textAnchor:"middle",fontFamily:"Arial Black",fontSize:"50",fontVariant:"small-caps"},e.title)))},X=function(){var e=Object(c.e)((function(e){return e.battle.showTitle})),t=Object(c.e)((function(e){return e.battle.showStart})),n=Object(c.e)((function(e){return e.battle.title}));return Object(a.useEffect)((function(){}),[t,e,t]),r.a.createElement("g",null,t&&r.a.createElement(r.a.Fragment,null,r.a.createElement("g",null,r.a.createElement("rect",{x:"-250",y:"-100",width:"500",height:"200",fill:"black"}),r.a.createElement("text",{fill:"white",alignmentBaseline:"central",textAnchor:"middle",fontFamily:"Arial Black",fontSize:"50"},"BATTLE"))),e&&r.a.createElement(Y,{title:n}))},K=function(){var e=Object(c.d)();return{block:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach((function(t){return e(l(Object(F.a)(Object(F.a)({},t),{},{blocked:!0})))}))},unblock:function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];n.forEach((function(t){return e(l(Object(F.a)(Object(F.a)({},t),{},{blocked:!1})))}))}}},J=n(3),$={getAngle360:function(e,t){var n=Math.atan2(t.y-e.y,t.x-e.x);return(n=360*(n>0?n:2*Math.PI+n)/(2*Math.PI))*Math.PI/180},getAngle:function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},getVelocity:function(e,t,n){var a=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)}(e,t);return{x:n*Math.cos(a),y:n*Math.sin(a)}}},Q=n(19),ee=n.n(Q),te=J.Engine.create(),ne=te.world;ne.timer=0,ne.gravity.y=0;var ae=r.a.createContext(ne),re=function(){var e=Object(a.useState)(te),t=Object(H.a)(e,2),n=t[0],r=(t[1],Object(c.d)());return Object(a.useEffect)((function(){function e(){ne.timer+=.016666,ne.timer=Math.round(100*ne.timer)/100}function t(e){e.pairs.forEach((function(e){return function(e){var t={};switch(t[e.bodyA.label]=e.bodyA,t[e.bodyB.label]=e.bodyB,Object.keys(t).sort().join("")){case"AttackPlayer":var n=t.Attack,a=t.Player,i=ie(n.damage,a);a.hp-=i;var o="".concat(t.Attack.name," attack dealt ").concat(i," damage points to you!");r(E(o));break;case"EnemyExploding":t.Exploding.explode(t.Enemy.position);break;case"EnemySpell":var c=0,l=t.Spell,u=t.Enemy;l.combine&&l.damage.push(oe),l.damage.forEach((function(e){c+=ie(e,u)})),u.hp-=c,l.remove(),u.hp<=0&&u.remove();var s="".concat(t.Spell.name.element).concat(t.Spell.name.shape," dealt ").concat(c," damage points!");r(E(s));break;default:return}}(e)}))}return J.Events.on(te,"beforeUpdate",e),J.Events.on(te,"collisionStart",(function(e){return t(e)})),function(){J.Events.off(te,"beforeUpdate",e),J.Events.off(te,"collisionStart",(function(e){return t(e)}))}}),[r]),n},ie=function(e,t){for(var n=0,a=0;a<e.amount;a++)n+=Math.ceil(Math.random()*e.sides);return n},oe={source:"force",amount:2,sides:6},ce=function(){var e=Object(a.useContext)(ae),t=Object(a.useRef)();void 0===t.current&&(t.current=[]);var n={stepGen:ee.a.mark((function e(){var t;return ee.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:return e.next=4,t++;case 4:e.next=1;break;case 6:case"end":return e.stop()}}),e)})),timeout:function(n,a){var r=e.timer,i=setInterval((function(){1e3*Math.abs(r-e.timer)>=a&&(clearInterval(i),n())}),10);t.current.push(i)},timeoutNext:function(e,t,a){n.timeout((function(){e(),t()}),a)},next:function(e,t){e(),t()},fnTimeoutNext:function(e,t,a){e(),n.timeout(t,a)},searchByX:function(e,t){var a=Math.floor(t.length/2);return t[a].x===e.x?t[a]:0===a?-1:t[a].x>e.x?n.searchByX(e,t.slice(0,a)):t[a].x<e.x?n.searchByX(e,t.slice(a)):void 0},searchTile:function(e,t){var a=t.filter((function(t){return t.y===e.y}));return 0===a.length?-1:n.searchByX(e,a)},getDistance:function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},searchID:function(e,t){var a=Math.floor(t.length/2);return t[a].id===e?t[a]:t[a].id>e?n.searchID(e,t.slice(0,a)):t[a].id<e?n.searchID(e,t.slice(a)):void 0},searchPlayer:function(e){for(var t in e)return"Player"===e[t].label?e[t]:-1}};return Object(a.useEffect)((function(){return function(){return t.current.forEach((function(e){return clearInterval(e)}))}}),[]),n},le=function(){var e=Object(c.d)(),t=Object(c.e)((function(e){return e.world.bodies}),c.c),n=Object(c.e)((function(e){return e.world.board})),r=Object(c.e)((function(e){return e.spellbook.spells})),i=Object(c.e)((function(e){return e.player})),o=Object(a.useRef)(),l=K(),u=ce();Object(a.useEffect)((function(){function a(s){if(!0!==o.current)if(i.moved&&s.target.attributes.tile){var d=u.searchPlayer(t),h=n[s.target.attributes.tile.value],b={x:h.x,y:h.y},E=$.getAngle(d.position,b);J.Body.setAngle(d,E),e(y(E)),e(w(!1)),e(m(!0))}else if(s.target.attributes.tile){o.current=!0,window.removeEventListener("click",a);var v=u.searchPlayer(t),O=n[s.target.attributes.tile.value];if(O.blocked&&O.x!==i.position.x&&O.y!==i.position.y)return;var x={x:O.x,y:O.y};l.unblock(u.searchTile(v.position,n)),function e(t,a,r,i){var o=u.searchTile(t.position,n),l=r;if(0===l)return void i();var s=[];for(var f in o.connections)c(o.connections[f])||s.push([f,u.getDistance(o.connections[f],a)]);var d=s.sort((function(e,t){return e[1]-t[1]}));l<2&&(d=d.filter((function(e){return"top"!==e[0]&&"bot"!==e[0]&&"left"!==e[0]&&"right"!==e[0]})));if(u.getDistance(t.position,a)<=d[0][1])return e(t,a,0,i);var h=d[0][0];l-="top"===h||"bot"===h||"left"===h||"right"===h?2:1;t.move(o.connections[h],(function(){return e(t,a,l,i)}))}(v,x,v.moveSpeed,(function(){if(e(g(v.position)),e(p(!0)),l.block(u.searchTile(v.position,n)),o.current=!1,r.length>0){var t=Object(W.a)(r);t.forEach((function(e){return e.origin=x})),e(f(t))}}))}}function c(e){var t=u.searchTile(e,n);return-1===t||t.blocked}return window.addEventListener("click",a),function(){window.removeEventListener("click",a)}}),[r,n,e,l,i,u,t])},ue=function(){le();var e=50*"Move".length+100;return r.a.createElement("g",null,r.a.createElement("rect",{x:800+e/-2,y:380/3/-2-450,width:e,height:380/3,fill:"#1101AB",stroke:"white",strokeWidth:10}),r.a.createElement("text",{fill:"white",x:800,y:"-450",alignmentBaseline:"central",textAnchor:"middle",fontFamily:"Arial Black",fontSize:"50",fontVariant:"small-caps"},"MOVE"))},se=function(){var e=Object(c.e)((function(e){return e.chat.messages})),t=Object(c.e)((function(e){return e.screen.viewBox}));return Object(a.useEffect)((function(){document.querySelector("#hideChatWindow").beginElement()}),[e]),r.a.createElement("g",null,r.a.createElement("animate",{id:"hideChatWindow",attributeName:"opacity",to:"0",keyTimes:"0;0.75;1",values:"1;1;0",begin:"indefinite",fill:"freeze",dur:"4s"}),r.a.createElement("animate",{id:"showChatWindow",attributeName:"opacity",to:"1",begin:"indefinite",fill:"freeze",dur:"0.1s",calcMode:"discrete"}),r.a.createElement("rect",{x:t.width/-2,width:t.width/3.33,y:t.height/3.33,height:t.height/4,fill:"black",opacity:"0.3",onMouseOver:function(){return document.querySelector("#showChatWindow").beginElement()},onMouseLeave:function(){return document.querySelector("#hideChatWindow").beginElement()}}),e.map((function(n,a){return r.a.createElement("text",{key:"message".concat(a),x:t.width/-2+20,y:t.height/2-30*(e.length-a),alignmentBaseline:"middle",fill:"white",fontFamily:"Arial Black",fontSize:20,pointerEvents:"none"},n)})))},fe=function(e){return r.a.createElement("g",null,r.a.createElement("text",{x:e.x,y:e.y,alignmentBaseline:"central",fontFamily:"Arial Black",fontSize:"30",fill:"white",pointerEvents:"none"},e.children),r.a.createElement("rect",{onClick:e.onClick,width:e.width,height:e.height,x:e.x,y:e.y+e.height/-2,fill:"transparent"}))},de=function(){var e=Object(c.e)((function(e){return e.screen.viewBox})),t=Object(c.e)((function(e){return e.battle.next})),n=Object(c.d)();return r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{width:e.width/4,height:240,x:e.width/-2+10,fill:"green",stroke:"white",opacity:"0.5",strokeWidth:"10"}),r.a.createElement(fe,{onClick:function(){n(w(!0)),n(m(!1))},height:60,width:e.width/4-100,x:e.width/-2+50,y:60},"MOVE"),r.a.createElement(fe,{onClick:function(){n(u(!0)),n(m(!1))},height:60,width:e.width/4-100,x:e.width/-2+50,y:120},"PREPARE SPELL"),r.a.createElement(fe,{onClick:function(){n(m(!1)),t()},height:60,width:e.width/4-100,x:e.width/-2+50,y:180},"CAST SPELL"))},he=function(e){var t=ce();Object(a.useEffect)((function(){document.querySelectorAll(".result-text-character").forEach((function(e,n){t.timeout((function(){return e.beginElement()}),150*n)}))}),[t]);var n=e.fontSize*e.text.length>e.maxWidth?e.maxWidth/(e.text.length+2):e.fontSize,i=e.text.split("");return i.map((function(e,t){return r.a.createElement("text",{key:"result-title".concat(t),fontFamily:"Arial Black",alignmentBaseline:"central",textAnchor:"middle",fill:"white",opacity:"0",pointerEvents:"none",fontSize:n,x:n*i.length/-2+n*t+n/2},e,r.a.createElement("animate",{className:"result-text-character",attributeName:"opacity",to:"1",dur:"0.1s",calcMode:"discrete",begin:"indefinite",fill:"freeze"}))}))},me=function(){var e=Object(c.e)((function(e){return e.screen.viewBox})),t=Object(c.e)((function(e){return e.battle.result})),n=ce(),i=Object(c.d)(),o=e.width/2,l=e.height/4,u=9*l/10;switch(Object(a.useEffect)((function(){n.timeout((function(){return i(b(null))}),5e3)}),[n,i]),t){case"Victory":return r.a.createElement("g",null,r.a.createElement("rect",{width:o,height:l,x:o/-2,y:l/-2,fill:"#1101AB",opacity:"0.5",stroke:"white",strokeWidth:"30"}),r.a.createElement(he,{maxWidth:o,fontSize:u,text:"VICTORY!"}));case"Defeat":return r.a.createElement("g",null,r.a.createElement("rect",{width:o,height:l,x:o/-2,y:l/-2,fill:"maroon",opacity:"0.5",stroke:"white",strokeWidth:"30"}),r.a.createElement(he,{maxWidth:o,fontSize:u,text:"DEFEAT"}));default:return r.a.createElement(r.a.Fragment,null)}},be=function(){var e=Object(c.e)((function(e){return e.screen.pause})),t=Object(c.e)((function(e){return e.spellbook.show})),n=Object(c.e)((function(e){return e.battle.show})),a=Object(c.e)((function(e){return e.move.show})),i=Object(c.e)((function(e){return e.world.showScenario})),o=Object(c.e)((function(e){return e.battle.showMenu})),l=Object(c.e)((function(e){return e.battle.result}));return r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(X,null),t&&r.a.createElement(Z,null),a&&r.a.createElement(ue,null),o&&r.a.createElement(de,null),i&&r.a.createElement(se,null),e&&r.a.createElement(M,null),l&&r.a.createElement(me,null))};var ye=Object(c.b)((function(e){return{viewBox:e.screen.viewBox}}))((function(e){var t=Object(F.a)({},e.viewBox),n=t.height,a=t.width;return r.a.createElement("g",null,r.a.createElement("path",{fill:"rgb(5,0,5)",opacity:"1",filter:"url(#shadow-blur)",d:"M 0 ".concat(n/-2+100,"L ").concat(a/2-50," 50 L 0 ").concat(n/2," L ").concat(a/-2+50," 50 Z")}),r.a.createElement("path",{fill:"transparent",d:"M 0 ".concat(n/-2+50,"L ").concat(a/2-50," 0 L 0 ").concat(n/2-50," L ").concat(a/-2+50," 0 Z")}))})),ge=r.a.memo((function(e){return r.a.createElement("path",{id:e.id,fill:e.fill,tile:e.tile,opacity:e.opacity,stroke:"darkgreen",strokeWidth:"5",transform:"translate(0 -1000)",d:"\n                M ".concat(e.x-e.width/2," ").concat(e.y,"\n                L ").concat(e.x," ").concat(e.y-e.height/2,"\n                L ").concat(e.x+e.width/2," ").concat(e.y,"\n                L ").concat(e.x," ").concat(e.y+e.height/2,"\n                Z")},r.a.createElement("animate",{attributeName:"opacity",begin:"mouseover",to:"0.75",dur:"0.01s",fill:"freeze"}),r.a.createElement("animate",{attributeName:"opacity",to:"0.5",begin:"mouseleave",from:"0.75",dur:"0.01s",fill:"freeze"}),r.a.createElement("animateTransform",{className:"board-tiles-fall",attributeName:"transform",type:"translate",to:"0 0",calcMode:"spline",keyTimes:"0;1",keySplines:"".concat(Math.random()," ").concat(Math.random()," ").concat(Math.random()," ").concat(Math.random()),dur:"2.5s",begin:"indefinite",fill:"freeze"}))}));var pe=Object(c.b)((function(e){return{viewBox:e.screen.viewBox,board:e.world.board}}))((function(e){return Object(a.useEffect)((function(){document.querySelectorAll(".board-tiles-fall").forEach((function(e){return e.beginElement()}))}),[]),e.board.map((function(e,t){return r.a.createElement(ge,{key:"tile".concat(t),id:"square".concat(t),tile:t,width:e.width,height:e.height,fill:"green",opacity:"0.5",x:e.x,y:e.y})}))})),we=function(e){var t="opacity-start-button",n="scale-y-start-button",i="scale-x-start-button",o="opacity-text-start-button",c=ce();return Object(a.useEffect)((function(){c.timeout((function(){return document.querySelector("#".concat(t)).beginElement()}),2500),c.timeout((function(){return document.querySelector("#".concat(n)).beginElement()}),2550),c.timeout((function(){return document.querySelector("#".concat(i)).beginElement()}),2700),c.timeout((function(){return document.querySelector("#".concat(o)).beginElement()}),3200)}),[t,n,i,o,c]),r.a.createElement("g",null,r.a.createElement("rect",{fill:"blue",opacity:"0",width:"200",height:"50",x:"-100",y:"-25",transform:"scale(0 0)",onClick:e.onClick},r.a.createElement("animate",{begin:"mouseenter",attributeName:"fill",to:"rgb(70, 45, 255)",id:"hover",fill:"freeze",dur:".1s",calcMode:"discrete"}),r.a.createElement("animate",{begin:"mouseleave",attributeName:"fill",to:"blue",id:"leaveHover",fill:"freeze",dur:".1s",calcMode:"discrete"}),r.a.createElement("animateTransform",{id:n,attributeName:"transform",type:"scale",to:"0 5",begin:"indefinite",fill:"freeze",additive:"sum",dur:".25s"}),r.a.createElement("animate",{id:t,attributeName:"opacity",to:"1",begin:"indefinite",fill:"freeze",dur:"0.1s",calcMode:"discrete"}),r.a.createElement("animateTransform",{id:i,attributeName:"transform",type:"scale",to:"5 5",begin:"indefinite",fill:"freeze",additive:"replace",dur:".5s"})),r.a.createElement("text",{fontFamily:"Cinzel Decorative",textAnchor:"middle",alignmentBaseline:"central",fontSize:"75",fill:"white",opacity:"0"},"BATTLE START",r.a.createElement("animate",{id:o,attributeName:"opacity",to:"1",begin:"indefinite",calcMode:"discrete",dur:".1s",fill:"freeze"})))},Ee=n(5),ve=n(7),Oe=n(6),xe=function e(t){var n=this;Object(Ee.a)(this,e),this.checkIfInArea=function(e,t,n){return Math.abs(t-e)<n},this.move=function(e,t){if(n.body.isStatic&&J.Body.setStatic(n.body,!1),n.checkIfInArea(n.body.position.x,e.x,8)&&n.checkIfInArea(n.body.position.y,e.y,8))J.Body.setVelocity(n.body,{x:0,y:0}),J.Body.setPosition(n.body,e),J.Body.setStatic(n.body,!0),t&&t();else{var a=$.getVelocity(n.body.position,e,8);J.Body.setVelocity(n.body,a),n.timeout((function(){return n.move(e,t)}),20)}},this.intervals=[],this.body=J.Bodies.circle(0,0,5),this.add=function(){return J.World.add(t,n.body)},this.remove=function(){for(var e in J.World.remove(t,n.body),n.intervals)clearInterval(n.intervals[e]);for(var a in n)delete n[a]},this.timeout=function(e,a){var r=t.timer,i=setInterval((function(){1e3*Math.abs(r-t.timer)>=a&&(e(),clearInterval(i))}),10);n.intervals.push(i)}},je=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i){var o;return Object(Ee.a)(this,n),(o=t.call(this,r)).body=J.Bodies.circle(e.x+45,e.y-27,5,{label:"Attack",isSensor:!0,name:"Slash",damage:a,remove:o.remove,move:o.move}),o.add(),o.move({x:e.x-45,y:e.y+27},(function(){i(),o.remove()})),o}return n}(xe),Se=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i,o){var c;return Object(Ee.a)(this,n),(c=t.call(this,i)).body=J.Bodies.circle(e.x,e.y,5,{label:"Attack",isSensor:!0,name:"Shot",damage:r,remove:c.remove,move:c.move}),c.add(),c.move(a,(function(){o(),c.remove()})),c}return n}(xe),ke=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i,o,c,l){var u;return Object(Ee.a)(this,n),(u=t.call(this,c)).fade=function(){l(),u.remove()},u.body=J.Bodies.circle(e.x,e.y,10,Object(F.a)({label:"Spell",name:i,isSensor:!0,damage:r,remove:u.fade},o)),u.add(),u.timeout((function(){return J.Body.setVelocity(u.body,$.getVelocity(e,a,30))}),1e3),u.timeout(u.fade,5e3),u}return n}(xe),Ae=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i,o,c){var l;return Object(Ee.a)(this,n),(l=t.call(this,o)).fade=function(){l.timeout((function(){c(),l.remove()}),2e3)},l.body=J.Bodies.circle(e.x,e.y,150,Object(F.a)({label:"Spell",name:r,isSensor:!0,damage:a,remove:l.fade},i)),l.add(),l.timeout(l.fade,5e3),l}return n}(xe),Te=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i,o,c,l){var u;return Object(Ee.a)(this,n),(u=t.call(this,c)).explode=function(e){new Ae(e,r,i,o,c,l),u.remove()},u.body=J.Bodies.circle(e.x,e.y,10,{label:"Exploding",name:i,isSensor:!0,damage:r,explode:u.explode}),u.add(),u.timeout((function(){return J.Body.setVelocity(u.body,$.getVelocity(e,a,20))}),1e3),u}return n}(xe),Be=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i,o){var c;return Object(Ee.a)(this,n),(c=t.call(this,o)).animate=function(){var e=document.querySelector("#rain".concat(c.body.id));void 0!==e&&null!==e&&e.beginElement()},c.fade=function(){return c.timeout(c.remove,3e3)},c.body=J.Bodies.circle(e.x,e.y,10,Object(F.a)({label:"Spell",name:r,isSensor:!0,damage:a,remove:c.fade},i)),c.add(),c.timeout(c.animate,0),c}return n}(xe),Pe=function(){var e=ce(),t=K(),n=Object(a.useContext)(ae),r=Object(a.useRef)();r.current=Object(c.e)((function(e){return e.world.board}));var i=Object(a.useRef)();i.current=Object(c.e)((function(e){return e.spellbook.spells}));var o=Object(a.useRef)();o.current=Object(c.e)((function(e){return e.player}));var l=Object(c.d)(),u=function(){var e=ce(),t=Object(c.d)();return function(n,a){var r=e.stepGen(),i=function(){return o[r.next().value]()},o=[function(){return e.next((function(){return t({type:"BATTLE_SPELL_TITLE_SET",payload:n.name.element[0].toUpperCase()+n.name.element.slice(1)+n.name.shape})}),i)},function(){return e.fnTimeoutNext((function(){return t(h(!0))}),i,500)},function(){return e.fnTimeoutNext((function(){return t(h(!1))}),i,500)},a];i()}}(),s=function(){var e=Object(c.e)((function(e){return e.world.bodies}),c.c),t=Object(a.useRef)();t.current=Object(c.e)((function(e){return e.player}));var n=Object(a.useContext)(ae),r=ce();return function(a,i){var o={x:t.current.position.x+Math.cos(t.current.angle),y:t.current.position.y+Math.sin(t.current.angle)},c={maximize:a.maximize,empower:a.empower,combine:a.combine};switch(a.target[a.target.length-1]){case"single":new ke(a.origin,o,a.damage,a.name,c,n,i);break;case"ball":new Te(a.origin,o,a.damage,a.name,c,n,i);break;case"all":e.forEach((function(e){"Enemy"===e.label&&new Be(e.position,a.damage,a.name,c,n)})),r.timeout(i,3e3);break;default:return}}}();return{start:function(e){l(d(!0)),e()},enemy:function(a,i){var c=e.stepGen(),l=function(){return u[c.next().value]()},u=[function(){return function(n,a){n.hp>0?(t.unblock(e.searchTile(n.position,r.current)),function n(a,i,c){var l=i;if(0===l)return J.Body.setAngle(a,$.getAngle(a.position,o.current.position)),t.block(e.searchTile(a.position,r.current)),void e.timeout(c,500);var u=e.searchTile(a.position,r.current),s=[];for(var f in u.connections)b(u.connections[f])||s.push([f,e.getDistance(u.connections[f],o.current.position)]);var d=s.sort((function(e,t){return e[1]-t[1]}));switch(a.behaviour){case"Ranged":if(d.reverse(),e.getDistance(a.position,o.current.position)>=d[0][1])return n(a,l=0,c);break;case"Melee":if(e.getDistance(a.position,o.current.position)<=d[0][1])return n(a,l=0,c)}l<2&&(d=d.filter((function(e){return"top"!==e[0]&&"bot"!==e[0]&&"left"!==e[0]&&"right"!==e[0]})));var h=d[0][0];l-="top"===h||"bot"===h||"left"===h||"right"===h?2:1;a.move(u.connections[h],(function(){return n(a,l,c)}))}(n,n.moveSpeed,a)):a()}(a,l)},function(){return function(t,a){if(t.hp>0&&t.damage.amount>0)switch(t.behaviour){case"Melee":e.getDistance(t.position,o.current.position)<135?new je(o.current.position,t.damage,n,a):a();break;case"Ranged":new Se(t.position,o.current.position,t.damage,n,a);break;default:return}else a()}(a,l)},i];l()},player:function(t){var n=e.stepGen(),a=function(){return r[n.next().value]()};l({type:"BATTLE_PHASE_FORCE_NEXT",payload:a});var r=[function(){return l(m(!0))},t];a()},cast:function(t){var n=e.stepGen(),a=function(){return o[n.next().value]()},r=i.current.map((function(e){return[function(){return u(e,a)},function(){return s(e,a)}]})),o=[].concat(Object(W.a)(r.flat()),[t]);a()},cleanup:function(e){l(p(!1)),l(f([])),e()}};function b(t){var n=e.searchTile(t,r.current);return-1===n||n.blocked}},Le=function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i){var o;return Object(Ee.a)(this,n),(o=t.call(this,i)).body=J.Bodies.circle(e.x,e.y,30,{label:"Player",isStatic:!0,hp:a,maxHP:a,moveSpeed:r,remove:o.remove,move:o.move}),o}return n}(xe),Ie={Enemy:function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a,r,i){var o;return Object(Ee.a)(this,n),(o=t.call(this,i)).body=J.Bodies.circle(e.x,e.y,30,{name:"Enemy",label:"Enemy",isStatic:!0,hp:a,maxHP:a,moveSpeed:r,remove:o.remove,move:o.move}),o}return n}(xe),Skeleton:function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a){var r;return Object(Ee.a)(this,n),(r=t.call(this,a)).body=J.Bodies.circle(e.x,e.y,30,{name:"Skeleton",label:"Enemy",isStatic:!0,damage:{amount:3,sides:6,element:"force"},behaviour:"Melee",hp:30,maxHP:30,moveSpeed:2,remove:r.remove,move:r.move}),r}return n}(xe),Warg:function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a){var r;return Object(Ee.a)(this,n),(r=t.call(this,a)).body=J.Bodies.circle(e.x,e.y,30,{name:"Warg",label:"Enemy",isStatic:!0,damage:{amount:2,sides:10,element:"force"},behaviour:"Melee",hp:50,maxHP:50,moveSpeed:4,remove:r.remove,move:r.move}),r}return n}(xe),Elf:function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a){var r;return Object(Ee.a)(this,n),(r=t.call(this,a)).body=J.Bodies.circle(e.x,e.y,30,{name:"Elf",label:"Enemy",isStatic:!0,damage:{amount:1,sides:10,element:"force"},behaviour:"Ranged",hp:25,maxHP:25,moveSpeed:3,remove:r.remove,move:r.move}),r}return n}(xe),Statue:function(e){Object(ve.a)(n,e);var t=Object(Oe.a)(n);function n(e,a){var r;return Object(Ee.a)(this,n),(r=t.call(this,a)).body=J.Bodies.circle(e.x,e.y,30,{name:"Stone Statue",label:"Enemy",isStatic:!0,damage:{amount:0,sides:0,element:"force"},behaviour:"Melee",hp:25,maxHP:25,moveSpeed:0,remove:r.remove,move:r.move}),r}return n}(xe)},_e=function(){var e=Object(c.e)((function(e){return e.world.currentPage})),t=Object(c.e)((function(e){return e.player})),n=Object(c.e)((function(e){return e.world.board})),r=Object(a.useContext)(ae),i=Object(c.e)((function(e){return e.world.fights})),o=Object(c.d)(),l=function(){var e=Object(c.d)(),t=ce(),n=Object(c.e)((function(e){return e.world.currentPage})),r=Object(a.useContext)(ae);return{victory:function(){e(b("Victory")),t.timeout((function(){e(p(!1)),e({type:"FIGHT_ENTRY_UPDATE",payload:n}),e(x(n+1)),e(f([])),e(b(null)),e(d(!1));for(var t=r.bodies.length-1;t>=0;t--)r.bodies[t].remove()}),2e3),t.timeout((function(){e(f([])),e(v(!1)),e(O(!0))}),2500)},defeat:function(){e(b("Defeat")),t.timeout((function(){e(p(!1)),e(b(null)),e(d(!1));for(var t=r.bodies.length-1;t>=0;t--)r.bodies[t].remove()}),2e3),t.timeout((function(){e(v(!1)),e(O(!0))}),2500)}}}(),u=K(),s=function(e){var t=Object(a.useRef)();t.current=Object(c.e)((function(e){return e.world.bodies}),c.c);var n=ce(),r=Pe();return function(){var a=n.stepGen(),i=function(){var r=t.current.filter((function(e){return"Enemy"===e.label&&e.hp>0})),i=t.current.filter((function(e){return"Player"===e.label}));0===r.length?n.timeout((function(){return e.victory()}),1e3):i[0].hp<=0?n.timeout((function(){return e.defeat()}),1e3):o[a.next().value]()},o=[function(){return r.start(i)},function e(){var n=t.current.filter((function(e){return"Player"===e.label||"Enemy"===e.label})).sort((function(e,t){return e.moveSpeed-t.moveSpeed})).reverse().map((function(e){return"Player"===e.label?[function(){return r.player(i)},function(){return r.cast(i)}]:function(){return r.enemy(e,i)}}));o.push.apply(o,Object(W.a)(n.flat()).concat([function(){return r.cleanup(i)},e])),i()}];i()}}(l);return function(){o(O(!1)),Me[i[e]].start(t,n,u,r,o),setTimeout(s,500)}},Me={training:{start:function(e,t,n,a,r){var i=Object(F.a)({},t[51]),o=Object(F.a)({},t[12]),c=new Le(i,e.maxHP,e.speed,a);J.Body.setAngle(c.body,-90*Math.PI/180),r(y(c.body.angle)),r(g(c.body.position));var l=new Ie.Statue(o,a);l.body.hp=1,c.add(),l.add(),J.Body.setAngle(l.body,90*Math.PI/180),n.block(i,o)}},training2:{start:function(e,t,n,a,r){var i=Object(F.a)({},t[51]),o=Object(F.a)({},t[12]),c=new Le(i,e.maxHP,e.speed,a);J.Body.setAngle(c.body,-90*Math.PI/180),r(y(c.body.angle)),r(g(c.body.position)),r(s(4));var l=new Ie.Statue(o,a);c.add(),l.add(),J.Body.setAngle(l.body,90*Math.PI/180),n.block(i,o)}},training3:{start:function(e,t,n,a,r){var i=Object(F.a)({},t[51]),o=Object(F.a)({},t[12]),c=new Le(i,e.maxHP,e.speed,a);r(s(6)),J.Body.setAngle(c.body,-90*Math.PI/180),r(y(c.body.angle)),r(g(c.body.position));var l=new Ie.Elf(o,a);l.body.moveSpeed=0,l.body.name="Caster Statue",J.Body.setStatic(l.body,!0),c.add(),l.add(),J.Body.setAngle(l.body,90*Math.PI/180),n.block(i,o)}},training4:{start:function(e,t,n,a,r){var i=Object(F.a)({},t[51]),o=Object(F.a)({},t[4]),c=Object(F.a)({},t[11]),l=Object(F.a)({},t[13]),u=new Le(i,e.maxHP,e.speed,a);r(s(8)),J.Body.setAngle(u.body,-90*Math.PI/180),r(y(u.body.angle)),r(g(u.body.position));var f=new Ie.Elf(o,a),d=new Ie.Warg(c,a);d.body.name="Gargoyle";var h=new Ie.Warg(l,a);h.body.name="Gargoyle",f.body.moveSpeed=0,f.body.name="Caster Statue",J.Body.setStatic(f.body,!0),u.add(),f.add(),d.add(),h.add(),J.Body.setAngle(f.body,90*Math.PI/180),n.block(i,o)}}},Re=function(){var e=_e(),t=Object(c.e)((function(e){return e.world.showStartButton}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(ye,null),r.a.createElement(pe,null),t&&r.a.createElement(we,{onClick:e}))},Fe=function(e){var t=Object(c.e)((function(e){return e.screen.viewBox})),n=(t.width-200)/2,a=t.height-200,i=e.text.map((function(e){return We(e,Math.floor(n/50))})).flat(),o=He(50,i,a);return r.a.createElement("g",null,e.title&&r.a.createElement(Ue.PageTitle,{title:e.title}),e.text&&r.a.createElement(Ue.PageColumns,{columns:o,margin:100,fontSize:50}))},We=function(e,t){for(var n=e.split(" "),a=[],r=0;r<n.length;r++){for(var i=n[r];i.length<t;){i=i+" "+(void 0===n[++r]?"":n[r])}a.push(i)}return a},He=function(e,t,n){var a=Math.floor(n/(1.5*e)-1);return[t.slice(0,a),t.slice(a)]},Ue={Background:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("rect",{x:e.x,y:e.y,width:e.width,height:e.height,fill:"black"}))},Title:function(){return r.a.createElement("text",{fontSize:"100",fontFamily:"Cinzel Decorative",textAnchor:"middle",alignmentBaseline:"central",fill:"white",pointerEvents:"none"},"MAGE")},Arrows:function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{id:"leftArrow",transform:"translate(".concat(e.x+25," ").concat(-e.y-100,")"),d:" M 0 0 L 100 -100 L 50 0 L 100 100 Z",fill:"white"}),r.a.createElement("rect",{width:"100",height:"200",fill:"transparent",opacity:"0.5",transform:"translate(".concat(e.x+25," ").concat(-e.y-200,")"),onClick:function(){return e.onClick(-1)}}),r.a.createElement("path",{id:"rightArrow",transform:"translate(".concat(-e.x-25," ").concat(-e.y-100,")"),d:" M 0 0 L -100 -100 L -50 0 L -100 100 Z",fill:"white"}),r.a.createElement("rect",{width:"100",height:"200",fill:"transparent",opacity:"0.5",transform:"translate(".concat(-e.x-125," ").concat(-e.y-200,")"),onClick:function(){return e.onClick(1)}}))},AnimateFade:function(){return r.a.createElement("animate",{id:"fade-overworld-screen",attributeName:"opacity",to:"0",dur:"0.5s",fill:"freeze",begin:"indefinite"})},Screen:function(e){var t=Object(c.e)((function(e){return e.screen.viewBox})),n={x:t.width/-2,y:t.height/-2,width:t.width,height:t.height,fill:"black"};return r.a.createElement("g",null,r.a.createElement(Ue.Background,n),e.children,r.a.createElement(Ue.Arrows,Object.assign({},n,{onClick:e.onClick})),e.fight&&r.a.createElement("rect",{x:t.width/2-125,y:t.height/2-200,width:"100",height:"200",fill:"transparent",onClick:e.startFight}),r.a.createElement(Ue.AnimateFade,null))},Page:Fe,PageTitle:function(e){return r.a.createElement("text",{fontSize:"100",fontFamily:"Cinzel Decorative",textAnchor:"middle",alignmentBaseline:"central",fill:"white",pointerEvents:"none"},e.title)},PageColumns:function(e){return r.a.createElement("g",{transform:"translate(".concat(e.margin," ").concat(e.margin,")")},e.columns.map((function(t,n){return r.a.createElement(Ue.PageColumn,{key:"Column".concat(n),column:n,content:t,fontSize:e.fontSize})})))},PageColumn:function(e){var t=Object(c.e)((function(e){return e.screen.viewBox}));return e.content.map((function(n,a){return r.a.createElement(Ue.PageLine,{key:"PageLine".concat(a),width:t.width,height:t.height,fontSize:e.fontSize,column:e.column,content:n,line:a})}))},PageLine:function(e){return r.a.createElement("text",{x:e.width/-2+e.width/2*e.column,y:e.height/-2+e.line*e.fontSize*1.5+e.fontSize,fontSize:e.fontSize,fontFamily:"Cinzel Decorative",fill:"white",pointerEvents:"none"},e.content)}},Ce=[{title:"Meowge",text:[],fight:!1},{title:"Chapter I - Real Meowgic",text:[],fight:!1},{title:"",fight:"training",text:["Welcome to your first lesson of Runemoewgic, neophyte.","","We are supposed to spend the first hour or so explaining the why we can use magic, but that's boring.","","To cast a spell, simply write the correct rune sequence, then simply cast it.","","Let's see, how about we start with FU, the rune of FIRE.","","Go to your spellbook, write FU, and cast that spell to destroy the golem."]},{title:"",fight:!1,text:["Excellent work neophyte, that was a textbook example of taking too long.","","In any case, let's review some facts from the textbook.","","Fact number one: There are four elements. Actually five but don't quote me on that.","","Fact number two: FIRE, EARTH, WATER, WIND. Their runes are FU, TI, GA and VE. Wrong."]},{title:"",fight:"training",text:["Fact number three: only elemental runes makes your spell stronger. Wrong again, of course.","","Fact number four: the only way to start a full spell is with an elemental rune. Look at that, they got something right.","Fact number five: Every one rune spell should do between two and twelve damage points.","Well, that's enough wrong data for now. For now, just focus on destroying the golem with the other runes.","","Remember; FU TI GA VE. Then cast away."]},{title:"",fight:!1,text:["I knew you could do it, neophyte","","So further on the power side of the spell, every elemental rune adds between one and six points of damage.","","Don't ask me to convert points of damage into joules, the formula is in your textbook somewhere.","","However, the element of the spell is established by the first rune only. Exceptions aside."]},{title:"",fight:!1,text:["In any case, while all runes have a somewhat random list of established incompatibilities, the elemental runes are compatible with almost all runes.","","A rune will only provide the full force of it's magical power if the rune preceding is not incompatible.","","For example, GA and FU, WATER and FIRE, are incompatible, and won't work with each other at all."]},{title:"",fight:"training2",text:["So if you were to cast, say, FU-GA, the FU rune would work, but the GA rune would fizzle and not add anything to the spell. The same goes for GA-FU.","","The full incompatibility list is as follows:","","EARTH: VE and FU","FIRE: GA and TI","WATER: FU and VE","WIND: TI and FU","","Here's an additional Rune Slot to try some of your new spells now. If done right you should be adding, in average, about 3.5 points of damage to your spell."]},{title:"",fight:!1,text:["Great work neophyte, you're getting better.","","So back to incompatibilities, we are intelligent meowges, so we found out that even if two runes are incompatible, we can make them work together.","","That is, using another compatible rune as a link.","","Going back to FU-GA, to make that spell work you would need to add another rune in the middle to work as a link."]},{title:"",fight:!1,text:["Any rune would work, even incompatible runes. Take for example, FU-GA-GA, the first and the last would function, and the link would fizzle, but still work as a link.","","But that would be wasteful, and meowges are everything except wasteful.","","So instead of using an incompatible rune, we are going refactor this into a working spell."]},{title:"",fight:!1,text:["For example, the EARTH rune, is compatible with the FIRE rune, and the WATER rune is compatible with the EARTH rune. As such, FU-TI-GA, is a fully working spell.","","If instead of using the EARTH rune we wanted, for mysterious reasons, to use the WIND rune, that would be a little more complicated, but still possible.","","VE is incompatible with FU, but compatible with GA. So, to make this work, we change the order to GA-VE-FU."]},{title:"",fight:"training3",text:["Which would be a spell with the same power level of FU-TI-GA, although it distills into a bolt of a different element.","","And that's why I wanted you to remember FU-TI-GA-VE, that's the order of elemental rune compatibilities, FIRE, EARTH, WATER, WIND.","","Now it's time to put in practice some of this, why don't you fight against a more powerful golem? Go, neophyte."]},{title:"",fight:"training4",text:["Welcome to your final lesson, neophyte.","","Today you will prove to us that you know how to defend yourself.","","Remember: FU for FIRE, VE for WIND, GA for WATER, EARTH with TI.","","Come on now, we're waiting..."]},{title:"",fight:!1,text:["Congratulations, mage.","","Your first mission as a formal member of this magisterium is to retrieve the infamous ORB OF ZOT","","It's located on the lowest floor of the dungeon below.","Good luck."]}],Ne=function(){var e=Object(c.e)((function(e){return e.world.currentPage})),t=Object(c.e)((function(e){return e.world.fights})),n=Object(c.d)();return r.a.createElement(Ue.Screen,{onClick:function(t){return n(x(void 0!==Ce[e+t]?e+t:e))},fight:t[e],startFight:function(){return n(v(!0))}},r.a.createElement(Ue.Page,{title:Ce[e].title,text:Ce[e].text}))},ze=function(){var e=re(),t=Object(c.d)(),n=Object(a.useRef)(),r=Object(a.useRef)();r.current=Object(c.e)((function(e){return e.screen.pause})),Object(a.useEffect)((function(){return n.current=requestAnimationFrame((function a(){r.current||function(){J.Engine.update(e);var n=Object(W.a)(e.world.bodies);t(function(e){return{type:"UPDATE_BODIES",payload:e}}(n))}(),n.current=requestAnimationFrame(a)})),function(){cancelAnimationFrame(n.current)}}),[e,t])},De=function(){var e=Object(c.d)(),t=Object(c.e)((function(e){return e.screen.pause})),n=Object(c.e)((function(e){return e.world.showScenario}));return j(),ze(),Object(a.useEffect)((function(){var n=function(n){"Escape"===n.key&&e({type:"PAUSE_SET",payload:!t})};return window.addEventListener("keydown",n),function(){window.removeEventListener("keydown",n)}}),[t,e]),r.a.createElement(r.a.Fragment,null,n&&r.a.createElement(Re,null),r.a.createElement(B,null),!n&&r.a.createElement(Ne,null),r.a.createElement(be,null))},Ge=function(){return r.a.createElement("symbol",{id:"playerSprite",width:"32",height:"32",viewBox:"0 0 32 32"},r.a.createElement("path",{fill:"blue",d:"M 9.04,18.04\r C 9.04,18.04 5.04,32.04 5.04,32.04\r 5.04,32.04 26.04,32.04 26.04,32.04\r 26.04,32.04 23.04,18.04 23.04,18.04\r 16.00,15.00 16.00,15.00 9.04,18.04 Z"}),r.a.createElement("path",{id:"scarf",fill:"goldenrod",d:"M 16.00,18.00\r C 13.00,18.00 10.00,17.00 10.00,17.00\r 10.00,17.00 11.00,19.00 13.00,19.00\r 21.00,19.00 23.00,24.00 23.00,24.00\r 23.00,24.00 24.00,19.50 21.00,19.00\r 20.84,17.88 22.00,17.00 22.00,17.00\r 22.00,17.00 19.00,18.00 16.00,18.00 Z"}),r.a.createElement("path",{fill:"grey",d:"M 11.00,7.00\r C 10.89,7.07 9.11,5.93 9.00,6.00\r 4.00,23.00 28.00,23.00 23.00,6.00\r 22.89,5.95 21.12,7.05 21.00,7.00\r 18.00,6.00 14.00,6.00 11.00,7.00 Z"}),r.a.createElement("path",{fill:"yellow",d:"M 3.00,11.00\r C 8.00,13.00 8.00,11.00 9.00,10.00\r 10.00,9.00 22.00,9.00 23.00,10.00\r 24.00,11.00 24.00,13.00 29.00,11.00\r 21.00,9.00 19.00,5.00 16.00,0.00\r 13.00,5.00 11.00,9.00 3.00,11.00 Z"}),r.a.createElement("ellipse",{fill:"cyan",cx:"13",cy:"12",ry:"1.2",rx:".6"}),r.a.createElement("ellipse",{fill:"cyan",cx:"19",cy:"12",ry:"1.2",rx:"0.6"}))};var Ve=Object(c.b)((function(e){return{viewBox:e.screen.viewBox}}))((function(e){var t={height:e.viewBox.height,width:9*e.viewBox.height/16,x:9*e.viewBox.height/16/-2,y:e.viewBox.height/-2},n={width:4*e.viewBox.width/5,height:1*e.viewBox.height/4,x:4*e.viewBox.width/5/-2,y:1*e.viewBox.height/4/-2};return r.a.createElement("defs",null,r.a.createElement("style",{type:"text/css"},'@import url("https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@700&display=swap")'),r.a.createElement("radialGradient",{id:"background-radial",cx:"50%",cy:"50%",fx:"50%",fy:"50%"},r.a.createElement("stop",{offset:"0%",stopColor:"white",stopOpacity:"1"}),r.a.createElement("stop",{offset:"100%",stopColor:"black",stopOpacity:"1"})),r.a.createElement("filter",{id:"spellbook-filter"},r.a.createElement("feTurbulence",Object.assign({},n,{baseFrequency:"0.1",numOctaves:"5"}))),r.a.createElement("filter",{id:"shadow-blur"},r.a.createElement("feGaussianBlur",{stdDeviation:"4"})),r.a.createElement("mask",Object.assign({},n,{id:"spellbook-mask"}),r.a.createElement("rect",Object.assign({},n,{fill:"black"})),r.a.createElement("rect",Object.assign({},n,{fill:"white",rx:"20"}))),r.a.createElement("filter",{id:"menu-filter"},r.a.createElement("feTurbulence",Object.assign({},t,{baseFrequency:"0.1",numOctaves:"5"}))),r.a.createElement("mask",Object.assign({id:"menu-background-mask"},t),r.a.createElement("rect",Object.assign({},t,{fill:"black"})),r.a.createElement("rect",Object.assign({},t,{fill:"white",rx:"20"}))),r.a.createElement(Ge,null))}));var qe=Object(c.b)((function(e){return Object(F.a)({},e.screen.viewBox)}))((function(e){return r.a.createElement("svg",{id:"main-svg",viewBox:"".concat(e.width/-2," ").concat(e.height/-2," ").concat(e.width," ").concat(e.height),preserveAspectRatio:"xMidYMid meet"},r.a.createElement(Ve,null),r.a.createElement("rect",{fill:"black",width:"10000",height:"10000",x:"-5000",y:"-5000"}),r.a.createElement("rect",{fill:"url(#background-radial)",width:e.width,height:e.height,x:e.width/-2,y:e.height/-2}),r.a.createElement("rect",{fill:"transparent",stroke:"white",strokeWidth:"3",width:e.width,height:e.height,x:e.width/-2,y:e.height/-2}),e.children)})),Ze=n(37);n(34);for(var Ye=Object(Ze.a)((function(e){return r.a.createElement("div",{className:"App"},r.a.createElement(qe,null,r.a.createElement(De,{cookies:e.cookies})))})),Xe=n(8),Ke=window.innerHeight>9*window.innerWidth/16?9*window.innerWidth/16:window.innerHeight,Je=window.innerHeight>9*window.innerWidth/16?window.innerWidth:16*window.innerHeight/9,$e={width:2e3,height:1125},Qe={current:"start",viewBox:$e,pause:!1,svg:{height:Ke,width:Je,offset:(window.innerWidth-Je)/2*$e.width/Je,windowOffset:(window.innerWidth-Je)/-2}},et={position:{x:0,y:0}},tt=n(14),nt={},at=0;at<Ce.length;at++)nt[at]=Ce[at].fight;var rt={bodies:[],board:function(e,t){var n=function e(t,n,a,r,i){var o=[{x:1,y:0},{x:0,y:1},{x:-1,y:0},{x:0,y:-1}];for(var c in o){var l={width:t/2,height:n/2,x:a+t/4*o[c].x,y:r+n/4*o[c].y,blocked:!1};o[c]=l}var u=i-1;u>0&&o.map((function(t,n){return o[n]=e(t.width,t.height,t.x,t.y,u).flat()}));return o}(e-100,t-100,0,0,3).flat();return(n=n.sort((function(e,t){return function(e,t){var n=e.y-t.y;return e.y-t.y===0?e.x-t.x:n}(e,t)}))).forEach((function(e,t){return e.tile=t})),it(n),n}($e.width,$e.height),showScenario:!1,showStartButton:!0,currentPage:0,fights:nt};function it(e){for(var t in e){var n={top:{x:e[t].x,y:e[t].y-e[t].height},topleft:{x:e[t].x-e[t].width/2,y:e[t].y-e[t].height/2},topright:{x:e[t].x+e[t].width/2,y:e[t].y-e[t].height/2},left:{x:e[t].x-e[t].width,y:e[t].y},right:{x:e[t].x+e[t].width,y:e[t].y},botleft:{x:e[t].x-e[t].width/2,y:e[t].y+e[t].height/2},botright:{x:e[t].x+e[t].width/2,y:e[t].y+e[t].height/2},bot:{x:e[t].x,y:e[t].y+e[t].height}};e[t].connections=n}return e}var ot={show:!1},ct={show:!1,length:2,spells:[]},lt={HP:100,maxHP:100,speed:5,angle:0,position:{x:0,y:0},moved:!1},ut={show:!1,showStart:!1,showTitle:!1,title:"",showMenu:!1,result:null,next:function(){}},st={show:!1},ft={show:!1,messages:[]},dt=Object(Xe.b)({screen:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Qe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SHOW_SCREEN":return Object(F.a)(Object(F.a)({},e),{},{current:t.payload});case"RESIZE_SCREEN":return Object(F.a)(Object(F.a)({},e),{},{svg:t.payload});case"PAUSE_SET":return Object(F.a)(Object(F.a)({},e),{},{pause:t.payload});default:return e}},mouse:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:et,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOUSE_SET":return Object(F.a)(Object(F.a)({},e),{},{position:t.payload});default:return e}},world:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:rt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_BODIES":return Object(F.a)(Object(F.a)({},e),{},{bodies:t.payload});case"UPDATE_BOARD":return Object(F.a)(Object(F.a)({},e),{},{board:t.payload});case"UPDATE_TILE":return Object(F.a)(Object(F.a)({},e),{},{board:[].concat(Object(W.a)(e.board.slice(0,t.payload.tile)),[t.payload],Object(W.a)(e.board.slice(t.payload.tile+1)))});case"UPDATE_PAGE":return Object(F.a)(Object(F.a)({},e),{},{currentPage:t.payload});case"SCENARIO_SHOW":return Object(F.a)(Object(F.a)({},e),{},{showScenario:t.payload});case"START_BUTTON_SHOW":return Object(F.a)(Object(F.a)({},e),{},{showStartButton:t.payload});case"FIGHT_ENTRY_UPDATE":return Object(F.a)(Object(F.a)({},e),{},{fights:Object(F.a)(Object(F.a)({},e.fights),{},Object(tt.a)({},t.payload,!1))});default:return e}},UI:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ot,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UI_SHOW":return Object(F.a)(Object(F.a)({},e),{},{show:t.payload});default:return e}},spellbook:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ct,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SPELLBOOK_SHOW":return Object(F.a)(Object(F.a)({},e),{},{show:t.payload});case"SPELLBOOK_LENGTH_SET":return Object(F.a)(Object(F.a)({},e),{},{length:t.payload});case"SPELLBOOK_LOAD":return Object(F.a)(Object(F.a)({},e),{},{spells:t.payload});default:return e}},player:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:lt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"PLAYER_POSITION_SET":return Object(F.a)(Object(F.a)({},e),{},{position:t.payload});case"PLAYER_HP_SET":return Object(F.a)(Object(F.a)({},e),{},{HP:t.payload});case"PLAYER_ANGLE_SET":return Object(F.a)(Object(F.a)({},e),{},{angle:t.payload});case"PLAYER_MAXHP_SET":return Object(F.a)(Object(F.a)({},e),{},{maxHP:t.payload});case"PLAYER_MOVED_SET":return Object(F.a)(Object(F.a)({},e),{},{moved:t.payload});default:return e}},battle:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ut,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"BATTLE_SHOW":return Object(F.a)(Object(F.a)({},e),{},{show:t.payload});case"BATTLE_START_SHOW":return Object(F.a)(Object(F.a)({},e),{},{showStart:t.payload});case"BATTLE_SPELL_TITLE_SHOW":return Object(F.a)(Object(F.a)({},e),{},{showTitle:t.payload});case"BATTLE_SPELL_TITLE_SET":return Object(F.a)(Object(F.a)({},e),{},{title:t.payload});case"BATTLE_MENU_SHOW":return Object(F.a)(Object(F.a)({},e),{},{showMenu:t.payload});case"BATTLE_PHASE_FORCE_NEXT":return Object(F.a)(Object(F.a)({},e),{},{next:t.payload});case"BATTLE_RESULT_SET":return Object(F.a)(Object(F.a)({},e),{},{result:t.payload});default:return e}},move:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:st,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MOVE_SHOW":return Object(F.a)(Object(F.a)({},e),{},{show:t.payload});default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ft,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"CHAT_SHOW":return Object(F.a)(Object(F.a)({},e),{},{show:t.payload});case"CHAT_MESSAGES_SET":return Object(F.a)(Object(F.a)({},e),{},{messages:[].concat(Object(W.a)(e.messages),[t.payload]).slice(Math.max(e.messages.length-3,0))});default:return e}}}),ht=Object(Xe.d)(dt,Object(Xe.c)(window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.a,{store:ht},r.a.createElement(Ye,null))),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.e419675b.chunk.js.map